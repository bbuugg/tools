import{d as K,i as se,c,o as i,f as m,a as e,h as f,t as r,P as B,Z as F,a0 as te,u as oe,r as p,a2 as le,Q as T,V as n,a5 as H,U as w,a6 as ae,S as h,e as $,j as O,F as G,k as z,W as ne}from"./index-DRvybjyt.js";import{_ as re}from"./ToolLayout.vue_vue_type_script_setup_true_lang-CUa7i8NK.js";import{_ as E}from"./Button.vue_vue_type_script_setup_true_lang-DIUgJMZu.js";import{_ as de}from"./Textarea.vue_vue_type_script_setup_true_lang-DAiGv2gQ.js";import{u as ie}from"./useToast-BzYuoFtO.js";const ce={class:"space-y-2"},ue=["for"],ve={key:0,class:"text-error-400 ml-1"},pe={class:"relative"},be={key:0,class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},me=["id","type","value","placeholder","disabled","readonly"],fe={key:1,class:"absolute inset-y-0 right-0 pr-3 flex items-center"},we={key:1,class:"text-sm text-slate-400"},ge={key:2,class:"text-sm text-error-400"},_e={key:3,class:"text-sm text-success-400"},M=K({__name:"Input",props:{modelValue:{},type:{default:"text"},label:{},placeholder:{},helpText:{},errorMessage:{},successMessage:{},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},error:{type:Boolean,default:!1},success:{type:Boolean,default:!1},iconLeft:{},iconRight:{}},emits:["update:modelValue","blur","focus","keydown","keyup"],setup(Y,{emit:t}){const x=se(()=>`input-${Math.random().toString(36).substr(2,9)}`);return(l,a)=>(i(),c("div",ce,[l.label?(i(),c("label",{key:0,for:x.value,class:"block text-sm font-medium text-slate-200"},[f(r(l.label)+" ",1),l.required?(i(),c("span",ve,"*")):m("",!0)],8,ue)):m("",!0),e("div",pe,[l.iconLeft?(i(),c("div",be,[(i(),B(F(l.iconLeft),{class:"h-5 w-5 text-slate-400"}))])):m("",!0),e("input",te({id:x.value,type:l.type,value:l.modelValue,placeholder:l.placeholder,disabled:l.disabled,readonly:l.readonly,class:["block w-full transition-all duration-200 bg-slate-800/50 border border-slate-600/50 text-slate-100 placeholder-slate-400","focus:ring-2 focus:ring-primary-500 focus:border-primary-500","disabled:opacity-50 disabled:cursor-not-allowed","rounded-xl px-4 py-3",l.iconLeft?"pl-10":"",l.iconRight?"pr-10":"",l.error?"border-error-500 focus:border-error-500 focus:ring-error-500":"",l.success?"border-success-500 focus:border-success-500 focus:ring-success-500":""],onInput:a[0]||(a[0]=u=>l.$emit("update:modelValue",u.target.value)),onBlur:a[1]||(a[1]=u=>l.$emit("blur",u)),onFocus:a[2]||(a[2]=u=>l.$emit("focus",u)),onKeydown:a[3]||(a[3]=u=>l.$emit("keydown",u)),onKeyup:a[4]||(a[4]=u=>l.$emit("keyup",u))},l.$attrs),null,16,me),l.iconRight?(i(),c("div",fe,[(i(),B(F(l.iconRight),{class:"h-5 w-5 text-slate-400"}))])):m("",!0),l.clearable&&l.modelValue?(i(),c("button",{key:2,onClick:a[5]||(a[5]=u=>l.$emit("update:modelValue","")),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-200 transition-colors duration-200",type:"button"},[...a[6]||(a[6]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])):m("",!0)]),l.helpText?(i(),c("p",we,r(l.helpText),1)):m("",!0),l.error&&l.errorMessage?(i(),c("p",ge,r(l.errorMessage),1)):m("",!0),l.success&&l.successMessage?(i(),c("p",_e,r(l.successMessage),1)):m("",!0)]))}}),he={class:"space-y-6"},xe={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ye={class:"space-y-6"},Te={class:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20"},ke={class:"flex justify-between items-center mb-4"},Se={class:"text-xl font-semibold text-slate-100"},Ce={class:"text-sm px-2 py-1 rounded bg-slate-700 text-slate-300"},$e={class:"space-y-4"},Oe={class:"block text-sm font-medium text-slate-300 mb-2"},Ee={class:"flex space-x-2"},Re={class:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20"},Ve={class:"text-xl font-semibold mb-4 text-slate-100"},Ie={class:"mb-4"},Ae={class:"block text-sm font-medium text-slate-300 mb-2"},Ne={class:"flex space-x-2"},Le={class:"flex items-center text-slate-300"},Me={class:"mt-4"},Be={class:"block text-sm font-medium text-slate-300 mb-2"},Ue={class:"flex items-center justify-between"},De={class:"flex items-center space-x-4"},Pe={class:"flex items-center text-slate-300"},We=["disabled"],je={class:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20"},Fe={class:"text-xl font-semibold mb-4 text-slate-100"},He={id:"console-box",class:"bg-dark-900/50 rounded-lg p-4 h-48 overflow-y-auto font-mono text-sm"},Ge={key:0,class:"text-slate-400 h-full flex items-center justify-center"},ze={class:"text-slate-200"},Ke={class:"space-y-6"},Ye={class:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20"},qe={class:"flex justify-between items-center mb-4"},Qe={class:"text-xl font-semibold text-slate-100"},Xe={class:"space-y-4 mb-4"},Ze={class:"grid grid-cols-1 sm:grid-cols-3 gap-2"},Je={class:"flex items-center text-slate-300 text-sm"},es=["disabled"],ss={class:"flex items-center text-slate-300 text-sm"},ts=["disabled"],os={class:"flex items-center text-slate-300 text-sm"},ls=["disabled"],as={id:"message-box",class:"bg-dark-900/50 rounded-lg p-4 h-96 overflow-y-auto font-mono"},ns={key:0,class:"text-slate-400 h-full flex items-center justify-center"},rs={class:"mb-1"},ds={class:"text-slate-400 text-sm ml-2"},is=K({__name:"WsTool",setup(Y){const{t}=oe();ie();const x=p([]),l=p([]),a=p(null),u=p("ws://127.0.0.1:9501"),k=p(""),R=p(1),C=p("PING"),y=p(!1),g=p(void 0),V=p(!1),S=p(!1),I=p(!1),v=p(!1),A=p(!1),b=p({class:"success",state:!1,content:"",timer:void 0}),U=()=>{const d=new Date;return`${d.getHours().toString().padStart(2,"0")}:${d.getMinutes().toString().padStart(2,"0")}:${d.getSeconds().toString().padStart(2,"0")}`},q=(d,s)=>{b.value.timer&&clearTimeout(b.value.timer),b.value.state=!1,b.value.class=d,b.value.content=s,b.value.state=!0,b.value.timer=window.setTimeout(()=>{b.value.state=!1},3e3)},N=(d,s)=>{x.value.push({content:s,type:d,time:U()}),H(()=>{P("console-box")})},D=(d,s)=>{S.value&&(l.value=[]),l.value.push({direction:d,content:s,time:U()}),H(()=>{S.value||P("message-box")})},_=(d,s)=>{N(d,s),q(d,s)},Q=d=>({1e3:"1000 CLOSE_NORMAL",1001:"1001 CLOSE_GOING_AWAY",1002:"1002 CLOSE_PROTOCOL_ERROR",1003:"1003 CLOSE_UNSUPPORTED",1004:"1004 CLOSE_RETAIN",1005:"1005 CLOSE_NO_STATUS",1006:"1006 CLOSE_ABNORMAL",1007:"1007 UNSUPPORTED_DATA",1008:"1008 POLICY_VIOLATION",1009:"1009 CLOSE_TOO_LARGE",1010:"1010 MISSING_EXTENSION",1011:"1011 INTERNAL_ERROR",1012:"1012 SERVICE_RESTART",1013:"1013 TRY_AGAIN_LATER",1014:"1014 CLOSE_RETAIN",1015:"1015 TLS_HANDSHAKE"})[d]||"0000 UNKNOWN_ERROR 未知错误",P=d=>{const s=document.getElementById(d);s&&(s.scrollTop=s.scrollHeight)},X=()=>{"WebSocket"in window?_("success",t("tools.wsTool.initSuccess")||"Initialization completed"):_("danger",t("tools.wsTool.browserNotSupport")||"Current browser does not support H5 WebSocket, please change browser")},Z=()=>{try{if(v.value)a.value?.close(1e3,"Active closure of the user");else{localStorage.setItem("address",u.value);const d=new WebSocket(u.value);a.value=d,d.onopen=s=>{console.warn(s),v.value=!0;const o=u.value.replace("ws://","").replace("wss://","");_("success",`${t("tools.wsTool.opened")} => ${o}`)},d.onclose=s=>{console.warn(s),y.value=!1,g.value&&clearInterval(g.value),v.value=!1,_("danger",`${t("tools.wsTool.closed")} => ${Q(s.code)}`)},d.onerror=s=>{console.warn(s),N("danger",t("tools.wsTool.errorOccurred")||"An error occurred, please open the browser console to view")},d.onmessage=s=>{if(console.warn(s),!A.value){const o=s.data;S.value&&(l.value=[]),D(0,o)}}}}catch(d){console.warn(d),_("danger",t("tools.wsTool.createWsFailed")||"Failed to create WebSocket object, please check the server address")}},J=()=>{y.value?(y.value=!1,g.value&&clearInterval(g.value)):(y.value=!0,g.value=window.setInterval(()=>{N("info",`${t("tools.wsTool.loopSend")}: ${C.value}`),W(C.value)},R.value*1e3))},W=d=>{const s=typeof d=="object"?k.value:d||k.value;try{a.value&&a.value.readyState===WebSocket.OPEN?(a.value.send(s),D(1,s),V.value&&typeof d=="object"&&(k.value="")):_("danger",t("tools.wsTool.sendFailed")||"Failed to send message, please check console for details")}catch(o){throw _("danger",t("tools.wsTool.sendFailed")||"Failed to send message, please check console for details"),o}},ee=()=>{l.value=[]};X();const j=localStorage.getItem("address");return j&&(u.value=j),le(()=>{g.value&&clearInterval(g.value),a.value?.close()}),(d,s)=>(i(),B(re,{title:n(t)("tools.wsTool.title"),description:n(t)("tools.wsTool.description")},{default:T(()=>[w(ae,{name:"slide-fade"},{default:T(()=>[b.value.state?(i(),c("div",{key:0,class:h(["fixed top-2 left-1/2 transform -translate-x-1/2 z-50 max-w-md w-full px-4",`bg-${b.value.class==="danger"?"red":b.value.class==="success"?"green":b.value.class==="info"?"blue":"yellow"}-500 text-white rounded-lg p-3 text-center shadow-lg`])},r(b.value.content),3)):m("",!0)]),_:1}),e("div",he,[e("div",xe,[e("div",ye,[e("div",Te,[e("div",ke,[e("h2",Se,r(n(t)("tools.wsTool.serverConfig")),1),e("span",Ce,[f(r(n(t)("tools.wsTool.status"))+": ",1),e("span",{class:h({"text-red-400":!a.value,"text-yellow-400":a.value&&a.value.readyState===0,"text-green-400":a.value&&a.value.readyState===1,"text-orange-400":a.value&&a.value.readyState===2,"text-gray-400":a.value&&a.value.readyState===3})},r(a.value?a.value.readyState===0?n(t)("tools.wsTool.notOpened"):a.value.readyState===1?n(t)("tools.wsTool.connected"):a.value.readyState===2?n(t)("tools.wsTool.closing"):n(t)("tools.wsTool.closedStatus"):n(t)("tools.wsTool.notCreated")),3)])]),e("div",$e,[e("div",null,[e("label",Oe,r(n(t)("tools.wsTool.serverAddress")),1),e("div",Ee,[w(M,{modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=o=>u.value=o),placeholder:n(t)("tools.wsTool.addressPlaceholder")||"Enter server address without prefix",disabled:v.value,class:"flex-1"},null,8,["modelValue","placeholder","disabled"]),w(E,{variant:v.value?"danger":"success",onClick:Z},{default:T(()=>[f(r(v.value?n(t)("tools.wsTool.closeConnection"):n(t)("tools.wsTool.openConnection")),1)]),_:1},8,["variant"])])])])]),e("div",Re,[e("h2",Ve,r(n(t)("tools.wsTool.packetSettings")),1),e("div",Ie,[e("label",Ae,r(n(t)("tools.wsTool.autoSend")),1),e("div",Ne,[w(M,{modelValue:R.value,"onUpdate:modelValue":s[1]||(s[1]=o=>R.value=o),modelModifiers:{number:!0},type:"number",min:"1",disabled:!v.value,class:"w-20"},null,8,["modelValue","disabled"]),e("div",Le,r(n(t)("tools.wsTool.secondsSend")),1),w(M,{modelValue:C.value,"onUpdate:modelValue":s[2]||(s[2]=o=>C.value=o),disabled:!v.value,class:"flex-1"},null,8,["modelValue","disabled"]),w(E,{variant:y.value?"danger":"success",disabled:!v.value,onClick:J},{default:T(()=>[f(r(y.value?n(t)("tools.wsTool.stopSend"):n(t)("tools.wsTool.startSend")),1)]),_:1},8,["variant","disabled"])])]),e("div",Me,[e("label",Be,r(n(t)("tools.wsTool.manualSend")),1),w(de,{modelValue:k.value,"onUpdate:modelValue":s[3]||(s[3]=o=>k.value=o),placeholder:n(t)("tools.wsTool.sendPlaceholder")||"Content to send to server",disabled:!v.value,rows:"3",class:"mb-3"},null,8,["modelValue","placeholder","disabled"]),e("div",Ue,[e("div",De,[e("label",Pe,[$(e("input",{"onUpdate:modelValue":s[4]||(s[4]=o=>V.value=o),type:"checkbox",disabled:!v.value,class:"mr-2 rounded bg-dark-800 border-dark-600 text-blue-500 focus:ring-blue-500"},null,8,We),[[O,V.value]]),f(" "+r(n(t)("tools.wsTool.clearAfterSend")),1)])]),w(E,{variant:"success",disabled:!v.value,onClick:W},{default:T(()=>[f(r(n(t)("tools.wsTool.sendToServer")),1)]),_:1},8,["disabled"])])])]),e("div",je,[e("h2",Fe,r(n(t)("tools.wsTool.debugMessages")),1),e("div",He,[x.value.length===0?(i(),c("div",Ge,r(n(t)("tools.wsTool.noDebugMessages")),1)):m("",!0),(i(!0),c(G,null,z(x.value,(o,L)=>(i(),c("div",{key:L,class:"mb-2"},[e("strong",{class:h(`text-${o.type==="danger"?"red":o.type==="success"?"green":o.type==="info"?"blue":"yellow"}-400`)},r(o.time)+" => ",3),e("span",ze,r(o.content),1)]))),128))])])]),e("div",Ke,[e("div",Ye,[e("div",qe,[e("h2",Qe,r(n(t)("tools.wsTool.messageHistory")),1),w(E,{variant:"secondary",size:"sm",onClick:ee},{default:T(()=>[f(r(n(t)("tools.wsTool.clearMessages")),1)]),_:1})]),e("div",Xe,[e("div",Ze,[e("label",Je,[$(e("input",{"onUpdate:modelValue":s[5]||(s[5]=o=>S.value=o),type:"checkbox",disabled:!v.value,class:"mr-2 rounded bg-dark-800 border-dark-600 text-blue-500 focus:ring-blue-500"},null,8,es),[[O,S.value]]),f(" "+r(n(t)("tools.wsTool.clearAfterReceive")),1)]),e("label",ss,[$(e("input",{"onUpdate:modelValue":s[6]||(s[6]=o=>I.value=o),type:"checkbox",disabled:!v.value,class:"mr-2 rounded bg-dark-800 border-dark-600 text-blue-500 focus:ring-blue-500"},null,8,ts),[[O,I.value]]),f(" "+r(n(t)("tools.wsTool.jsonDecode")),1)]),e("label",os,[$(e("input",{"onUpdate:modelValue":s[7]||(s[7]=o=>A.value=o),type:"checkbox",disabled:!v.value,class:"mr-2 rounded bg-dark-800 border-dark-600 text-blue-500 focus:ring-blue-500"},null,8,ls),[[O,A.value]]),f(" "+r(n(t)("tools.wsTool.pauseReceive")),1)])])]),e("div",as,[l.value.length===0?(i(),c("div",ns,r(n(t)("tools.wsTool.noMessages")),1)):m("",!0),(i(!0),c(G,null,z(l.value,(o,L)=>(i(),c("div",{key:L,class:h(["mb-4",{"text-left":o.direction,"text-right":!o.direction}])},[e("div",rs,[e("strong",{class:h(o.direction?"text-green-400":"text-blue-400")},r(o.direction?n(t)("tools.wsTool.sent"):n(t)("tools.wsTool.received")),3),e("span",ds,r(o.time),1)]),I.value?(i(),c("div",{key:1,class:h(["text-slate-200 whitespace-pre-wrap break-words text-left",{"bg-green-900/20 p-2 rounded":o.direction,"bg-blue-900/20 p-2 rounded":!o.direction}])},r(o.content),3)):(i(),c("div",{key:0,class:h(["text-slate-200 whitespace-pre-wrap break-words",{"text-left":o.direction,"text-right":!o.direction,"bg-green-900/20 p-2 rounded":o.direction,"bg-blue-900/20 p-2 rounded":!o.direction}])},r(o.content),3))],2))),128))])])])])])]),_:1},8,["title","description"]))}}),ms=ne(is,[["__scopeId","data-v-15b58359"]]);export{ms as default};
